<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title th:text=#{bids.title}></title>
	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
	<link rel="stylesheet" href="/css/global.css">
	<link rel="stylesheet" href="/css/comprar.css">
</head>

<body>
	<div th:replace="fragments/topbarLinks"></div>
	<section class="carro">
		<div id="carouselExampleControls" class="carousel slide fotos" data-ride="carousel">
			<div class="carousel-inner">
				<div class="carousel-item active">
					<img class="d-block w-100" th:src="${files[0]}" alt="Carro">
				</div>
				<div class="carousel-item" th:each="file: ${files}">
					<img class="d-block w-100" th:src="${file}" alt="Carro">
				</div>
			</div>
			<a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
				<span class="carousel-control-prev-icon" aria-hidden="true"></span>
				<span class="sr-only">Anterior</span>
			</a>
			<a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
				<span class="carousel-control-next-icon" aria-hidden="true"></span>
				<span class="sr-only">Pr√≥ximo</span>
			</a>
		</div>
		<div class="info">
			<ul class="dadosCarro">
				<li class="nomeModelo"
					th:text="${veiculo.modelo} + ' '+  ${veiculo.ano} + ' - ' + ${veiculo.quilometragem} + 'km'"></li>
				<li th:text="${veiculo.loja.nome}"></li>
				<li th:text="#{vehicle.license} + ': ' + ${veiculo.placa} "></li>
				<li th:text="#{vehicle.chassis} + ': ' + ${veiculo.chassi} "></li>
				<li id="preco" th:text="'R$' + ${veiculo.preco}"></li>
			</ul>
			<div th:each="pproposta : ${propostas}">
				<div th:if="${proposta.estado == 'ABERTO' && proposta.veiculo.id == veiculo.id}">
					<div th:with="block_proposta=True"></div>
					<div th:with="proposta_aberta=${proposta}"></div>
				</div>
			</div>
			<div th:switch="${block_proposta}">
				<form th:case="null" id="form_proposta" action="salvarProposta" method="post" th:object = "${proposta}">
					<input id="pvalor" type="number" name="valor" th:placeholder="#{bids.value}" th:field="*{valor}" 
					th:classappend="${#fields.hasErrors('valor')} ? is-invalid"/>
					<input id="pparcelas" type="number" name="parcelamento" th:placeholder="#{bids.number.installments}" th:field="*{parcelamento}"
							th:classappend="${#fields.hasErrors('parcelamento')} ? is-invalid" />
					<input id="proposta" type="submit" name="Proposta" th:value="#{bids.make}" />
				</form>
				<div align="center" th:case="*">
					<h1 class="label" th:text=#{customer.open.bid} />
					</h1>
					<table class="propostas">
						<thead>
							<tr>
								<th th:text=#{bids.date}></th>
								<th th:text=#{bids.value}></th>
								<th th:text=#{customer.cancel.bid}></th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td th:text=${proposta_aberta.data}></td>
								<td th:text="'R$' + ${proposta_aberta.valor} + ' ' + ${proposta_aberta.parcelamento}">
								</td>
								<td id="botao_cancelar">
									<a id="remover"
										href="../proposta/removerProposta?id=${pageScope.proposta_aberta.id}"
										th:text=#{bids.cancel} /></a>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
			<div class="descricao">
				<p th:text="#{vehicle.about} + ' ' + ${veiculo.descricao}" />
			</div>
	</section>
	<script src="/js/carrossel.js"></script>
</body>

</html>